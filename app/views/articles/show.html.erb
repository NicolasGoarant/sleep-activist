<%# app/views/articles/show.html.erb - Page d'un article avec image upload√©e %>

<%# Hero de l'article avec image de fond %>
<%= content_tag :section, style: "position: relative; min-height: 60vh; display: flex; align-items: center; padding-top: 6rem;" do %>

  <%# Image de fond avec overlay %>
  <% if @article.hero_image.attached? %>
    <%= content_tag :div, style: "position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 0;" do %>
      <%= image_tag @article.hero_image,
          alt: @article.title,
          style: "width: 100%; height: 100%; object-fit: cover;" %>
      <%= content_tag :div, "", style: "position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to bottom, rgba(15, 11, 61, 0.7), rgba(15, 11, 61, 0.95));" %>
    <% end %>
  <% else %>
    <%= content_tag :div, "", style: "position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to bottom, rgba(26, 20, 100, 0.8), rgba(15, 11, 61, 0.95)); z-index: 0;" %>
  <% end %>

  <%# Contenu du hero %>
  <%= content_tag :div, style: "position: relative; z-index: 2; max-width: 800px; margin: 0 auto; padding: 0 5%; text-align: center;" do %>

    <%# Cat√©gorie et temps de lecture %>
    <%= content_tag :div, style: "display: flex; gap: 1rem; justify-content: center; margin-bottom: 2rem; flex-wrap: wrap;" do %>
      <% if @article.category.present? %>
        <%= content_tag :span, @article.category, style: "background: rgba(255, 217, 61, 0.2); padding: 0.5rem 1.2rem; border-radius: 15px; color: var(--moon-yellow); font-weight: 500; font-size: 0.9rem; border: 1px solid rgba(255, 217, 61, 0.4);" %>
      <% end %>
      <% if @article.reading_time.present? %>
        <%= content_tag :span, "‚è±Ô∏è #{@article.reading_time} min de lecture", style: "color: var(--soft-lavender); font-size: 0.9rem; padding: 0.5rem 1.2rem; background: rgba(255, 255, 255, 0.05); border-radius: 15px;" %>
      <% end %>
    <% end %>

    <%# Titre %>
    <%= content_tag :h1, @article.title, style: "color: var(--warm-cream); font-family: 'Crimson Pro', serif; font-size: 3rem; margin-bottom: 1.5rem; line-height: 1.2; text-shadow: 0 4px 20px rgba(0,0,0,0.5);" %>

    <%# Date de publication %>
    <% if @article.published_at.present? %>
      <%= content_tag :p, style: "color: var(--soft-lavender); opacity: 0.8; font-size: 0.95rem;" do %>
        Publi√© le <%= @article.published_at.strftime("%d %B %Y") %>
      <% end %>
    <% end %>

  <% end %>
<% end %>

<%# Contenu de l'article %>
<%= content_tag :article, style: "max-width: 800px; margin: -4rem auto 6rem; padding: 0 5%; position: relative; z-index: 3;" do %>

  <%= content_tag :div, class: "article-content", style: "background: rgba(15, 11, 61, 0.95); border-radius: 20px; padding: 4rem; border: 1px solid rgba(184, 181, 232, 0.3); backdrop-filter: blur(10px); box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);" do %>
    <%= markdown(@article.content) %>
  <% end %>

  <%# Pied de l'article %>
  <%= content_tag :div, style: "margin-top: 4rem; padding-top: 2rem; border-top: 2px solid rgba(184, 181, 232, 0.2); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem;" do %>

    <%# Partage %>
    <%= content_tag :div do %>
      <%= content_tag :p, "Partager cet article :", style: "color: var(--soft-lavender); margin-bottom: 1rem; font-weight: 500;" %>
      <%= content_tag :div, style: "display: flex; gap: 1rem;" do %>
        <%= link_to "üê¶ Twitter", "https://twitter.com/intent/tweet?url=#{request.original_url}&text=#{@article.title}", target: "_blank", style: "padding: 0.8rem 1.5rem; background: rgba(184, 181, 232, 0.15); border-radius: 10px; color: var(--soft-lavender); text-decoration: none; transition: all 0.3s;" %>
        <%= link_to "üìò Facebook", "https://www.facebook.com/sharer/sharer.php?u=#{request.original_url}", target: "_blank", style: "padding: 0.8rem 1.5rem; background: rgba(184, 181, 232, 0.15); border-radius: 10px; color: var(--soft-lavender); text-decoration: none; transition: all 0.3s;" %>
        <%= link_to "üíº LinkedIn", "https://www.linkedin.com/sharing/share-offsite/?url=#{request.original_url}", target: "_blank", style: "padding: 0.8rem 1.5rem; background: rgba(184, 181, 232, 0.15); border-radius: 10px; color: var(--soft-lavender); text-decoration: none; transition: all 0.3s;" %>
      <% end %>
    <% end %>

    <%# Retour au blog %>
    <%= link_to blog_path, style: "padding: 1rem 2rem; background: var(--moon-yellow); border-radius: 12px; color: var(--deep-indigo); font-weight: 600; text-decoration: none; transition: all 0.3s; display: inline-block;" do %>
      ‚Üê Retour au blog
    <% end %>

  <% end %>
<% end %>

<%# CTA Newsletter %>
<%= content_tag :section, class: "newsletter-cta", style: "margin-top: 6rem;" do %>
  <%= content_tag :div, class: "newsletter-box" do %>
    <%= content_tag :h2, "Vous avez aim√© cet article ?" %>
    <%= content_tag :p do %>
      Recevez nos prochaines analyses directement dans votre bo√Æte mail.
      Une fois par semaine, sans spam.
    <% end %>
    <%= content_tag :div, style: "margin-top: 2rem; display: flex; gap: 1.5rem; justify-content: center; flex-wrap: wrap;" do %>
      <%= link_to "üìß S'inscrire √† la newsletter", newsletters_path, class: "cta-primary" %>
    <% end %>
  <% end %>
<% end %>

<%= content_tag :style, type: "text/css" do %>
  /* Style du contenu markdown */
  .article-content {
    color: var(--soft-lavender);
    line-height: 1.9;
  }

  .article-content h2 {
    color: var(--warm-cream);
    font-family: 'Crimson Pro', serif;
    font-size: 2rem;
    margin-top: 3rem;
    margin-bottom: 1.5rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid rgba(255, 217, 61, 0.3);
  }

  .article-content h3 {
    color: var(--warm-cream);
    font-family: 'Crimson Pro', serif;
    font-size: 1.5rem;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
  }

  .article-content p {
    margin-bottom: 1.5rem;
    font-size: 1.1rem;
  }

  .article-content strong {
    color: var(--warm-cream);
    font-weight: 600;
  }

  .article-content em {
    font-style: italic;
    color: var(--moon-yellow);
  }

  .article-content a {
    color: var(--moon-yellow);
    text-decoration: underline;
    transition: opacity 0.3s;
  }

  .article-content a:hover {
    opacity: 0.8;
  }

  .article-content ul, .article-content ol {
    margin-bottom: 1.5rem;
    padding-left: 2rem;
  }

  .article-content li {
    margin-bottom: 0.8rem;
  }

  .article-content blockquote {
    border-left: 4px solid var(--moon-yellow);
    padding-left: 2rem;
    margin: 2rem 0;
    font-style: italic;
    color: var(--warm-cream);
    background: rgba(255, 217, 61, 0.05);
    padding: 1.5rem 2rem;
    border-radius: 0 10px 10px 0;
  }

  .article-content code {
    background: rgba(255, 217, 61, 0.1);
    padding: 0.2rem 0.5rem;
    border-radius: 5px;
    font-family: 'Courier New', monospace;
    color: var(--moon-yellow);
  }

  .article-content pre {
    background: rgba(0, 0, 0, 0.3);
    padding: 1.5rem;
    border-radius: 10px;
    overflow-x: auto;
    margin: 2rem 0;
  }

  @media (max-width: 768px) {
    h1 {
      font-size: 2rem !important;
    }

    .article-content {
      padding: 2rem !important;
    }

    .article-content h2 {
      font-size: 1.5rem;
    }

    .article-content p {
      font-size: 1rem;
    }
  }
<% end %>
