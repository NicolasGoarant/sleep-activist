<%# app/views/articles/index.html.erb - Page du blog avec images upload√©es %>
<% hero_bg_url = asset_path('blog_hero_couple.jpg') %>

<%# Blog Hero avec image de fond %>
<%= content_tag :section, class: "hero blog-hero", style: "position: relative; min-height: 60vh; padding-top: 8rem; display: flex; align-items: center; overflow: hidden; background: url(#{hero_bg_url}) center center / cover no-repeat;" do %>

  <%# Overlay sombre PLUS L√âGER pour voir l'image %>
  <%= content_tag :div, "", style: "position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(to bottom, rgba(26, 20, 100, 0.4), rgba(15, 11, 61, 0.6)); z-index: 1;" %>

  <%# Contenu hero %>
  <%= content_tag :div, class: "hero-content", style: "position: relative; z-index: 2; max-width: 800px; margin: 0 auto; text-align: center; padding: 0 5%;" do %>
    <%= content_tag :h1, "Articles", style: "font-size: 3.5rem; margin-bottom: 1.5rem; text-shadow: 0 4px 20px rgba(0,0,0,0.8);" %>
    <%= content_tag :p, class: "hero-subtitle", style: "font-size: 1.3rem; line-height: 1.8; text-shadow: 0 2px 10px rgba(0,0,0,0.8);" do %>
      D√©couvrez nos r√©flexions et analyses sur le sommeil comme enjeu de soci√©t√©
    <% end %>
  <% end %>
<% end %>

<%# Grille d'articles avec images upload√©es %>
<%= content_tag :section, style: "padding: 6rem 5%; max-width: 1400px; margin: 0 auto;" do %>
  <%# Grille 2 colonnes %>
  <%= content_tag :div, style: "display: grid; grid-template-columns: repeat(auto-fill, minmax(400px, 1fr)); gap: 3rem;" do %>
    <% @articles.each do |article| %>
      <%= link_to article_path(article.slug), class: "article-card", style: "text-decoration: none; display: block;" do %>
        <%= content_tag :article, style: "background: rgba(255, 255, 255, 0.03); border-radius: 15px; overflow: hidden; border: 1px solid rgba(184, 181, 232, 0.2); transition: all 0.3s;" do %>

          <%# Image de l'article %>
          <%= content_tag :div, style: "height: 280px; overflow: hidden; position: relative;" do %>
            <% if article.hero_image.attached? %>
              <%= image_tag article.hero_image,
                  alt: article.title,
                  style: "width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s;",
                  class: "article-image" %>
            <% else %>
              <%# Fallback avec emoji et gradient %>
              <%= content_tag :div, style: "height: 100%; background: #{article.cover_gradient_style}; display: flex; align-items: center; justify-content: center; font-size: 5rem;" do %>
                <%= article.emoji || "üìù" %>
              <% end %>
            <% end %>
          <% end %>

          <%# Contenu de la carte %>
          <%= content_tag :div, style: "padding: 2rem;" do %>
            <%# Tags et temps de lecture %>
            <%= content_tag :div, style: "display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;" do %>
              <% if article.category.present? %>
                <%= content_tag :span, article.category, style: "background: rgba(#{article.category_color == 'var(--moon-yellow)' ? '255, 217, 61' : '184, 181, 232'}, 0.15); padding: 0.3rem 0.8rem; border-radius: 12px; color: #{article.category_color}; font-size: 0.8rem;" %>
              <% end %>
              <% if article.reading_time.present? %>
                <%= content_tag :span, "#{article.reading_time} min", style: "color: var(--soft-lavender); font-size: 0.8rem; opacity: 0.7;" %>
              <% end %>
            <% end %>

            <%# Titre %>
            <%= content_tag :h3, article.title, style: "color: var(--warm-cream); font-family: 'Crimson Pro', serif; font-size: 1.5rem; margin-bottom: 1rem; line-height: 1.4;" %>

            <%# Extrait %>
            <% if article.excerpt.present? %>
              <%= content_tag :p, article.excerpt, style: "color: var(--soft-lavender); line-height: 1.7; font-size: 0.95rem; margin-bottom: 1.5rem; opacity: 0.9;" %>
            <% end %>

            <%# CTA Lire %>
            <%= content_tag :div, style: "display: flex; justify-content: space-between; align-items: center; padding-top: 1rem; border-top: 1px solid rgba(184, 181, 232, 0.1);" do %>
              <%= content_tag :span, "Lire l'article", style: "color: var(--moon-yellow); font-weight: 500; font-size: 0.9rem;" %>
              <%= content_tag :span, "‚Üí", style: "color: var(--moon-yellow); font-size: 1.2rem;" %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>

<%# CTA Newsletter %>
<%= content_tag :section, class: "newsletter-cta" do %>
  <%= content_tag :div, class: "newsletter-box" do %>
    <%= content_tag :h2, "Ne manquez aucun article" %>
    <%= content_tag :p do %>
      Recevez nos nouvelles analyses directement dans votre bo√Æte mail.
      Une fois par semaine, sans spam.
    <% end %>
    <%= content_tag :div, style: "margin-top: 2rem; display: flex; gap: 1.5rem; justify-content: center; flex-wrap: wrap;" do %>
      <%= link_to "üìß S'inscrire √† la newsletter", newsletters_path, class: "cta-primary" %>
      <%= link_to "üéôÔ∏è √âcouter le podcast", podcast_path, class: "cta-secondary" %>
    <% end %>
  <% end %>
<% end %>

<style>
  .article-card article:hover {
    transform: translateY(-8px);
    box-shadow: 0 15px 50px rgba(255, 217, 61, 0.3);
    border-color: var(--moon-yellow);
  }

  .article-card:hover h3 {
    color: var(--moon-yellow);
  }

  .article-card:hover .article-image {
    transform: scale(1.05);
  }

  @media (max-width: 768px) {
    section > div:first-child {
      grid-template-columns: 1fr !important;
    }

    .hero h1 {
      font-size: 2.5rem !important;
    }

    .hero-subtitle {
      font-size: 1.1rem !important;
    }
  }

  @media (max-width: 500px) {
    .article-card article > div:first-child {
      height: 200px !important;
      font-size: 4rem !important;
    }

    .hero h1 {
      font-size: 2rem !important;
    }
  }
</style>
